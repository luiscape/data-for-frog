source_list <- c('fts', 'rw', 'sw')
source_list
paste(source_list)
paste0(source_list, "this")
source_list[1]
paste(source_list[1], "foo", sep = "")
x  <- read.csv(paste0('data/', src, '-', 'dataset.csv'))
# Creating empty data.frames.
final_dataset <- data.frame()
final_indicator <- data.frame()
final_value <- data.frame()
# Fetching and merging all data.
for (i in 1:length(source_list)) {
src <- source_list[i]
x  <- read.csv(paste0('data/', src, '-', 'dataset.csv'))
y  <- read.csv(paste0('data/', src, '-', 'indicator.csv'))
z  <- read.csv(paste0('data/', src, '-', 'fts-value.csv'))
if (i == 1) {
final_dataset <- x
final_indicator <- y
final_value <- z
}
else {
final_dataset <- rbind(final_dataset, x)
final_indicator <- rbind(final_dataset, y)
final_value <- rbind(final_dataset, z)
}
}
x  <- read.csv(paste0('data/', src, '-', 'dataset.csv'))
x
for (i in 1:length(source_list)) {
src <- source_list[i]
x  <- read.csv(paste0('data/', src, '-', 'dataset.csv'))
y  <- read.csv(paste0('data/', src, '-', 'indicator.csv'))
z  <- read.csv(paste0('data/', src, '-', 'fts-value.csv'))
if (i == 1) {
final_dataset <- x
final_indicator <- y
final_value <- z
}
else {
final_dataset <- rbind(final_dataset, x)
final_indicator <- rbind(final_dataset, y)
final_value <- rbind(final_dataset, z)
}
}
# Fetching and merging all data.
for (i in 1:length(source_list)) {
src <- source_list[i]
x  <- read.csv(paste0('data/', src, '-', 'dataset.csv'))
y  <- read.csv(paste0('data/', src, '-', 'indicator.csv'))
z  <- read.csv(paste0('data/', src, '-', 'value.csv'))
if (i == 1) {
final_dataset <- x
final_indicator <- y
final_value <- z
}
else {
final_dataset <- rbind(final_dataset, x)
final_indicator <- rbind(final_dataset, y)
final_value <- rbind(final_dataset, z)
}
}
# Fetching and merging all data.
for (i in 1:length(source_list)) {
src <- source_list[i]
x  <- read.csv(paste0('data/', src, '-', 'dataset.csv'))
y  <- read.csv(paste0('data/', src, '-', 'indicator.csv'))
z  <- read.csv(paste0('data/', src, '-', 'value.csv'))
print(names(x))
print(names(y))
print(names(z))
if (i == 1) {
final_dataset <- x
final_indicator <- y
final_value <- z
}
else {
final_dataset <- rbind(final_dataset, x)
final_indicator <- rbind(final_dataset, y)
final_value <- rbind(final_dataset, z)
}
}
# Fetching and merging all data.
for (i in 1:length(source_list)) {
src <- source_list[i]
x  <- read.csv(paste0('data/', src, '-', 'dataset.csv'))
y  <- read.csv(paste0('data/', src, '-', 'indicator.csv'))
z  <- read.csv(paste0('data/', src, '-', 'value.csv'))
print(ncol(x))
print(ncol(y))
print(ncol(z))
print(names(x))
print(names(y))
print(names(z))
if (i == 1) {
final_dataset <- x
final_indicator <- y
final_value <- z
}
else {
final_dataset <- rbind(final_dataset, x)
final_indicator <- rbind(final_dataset, y)
final_value <- rbind(final_dataset, z)
}
}
temp <- read.csv('data/rw-value.csv')
temp$source <- "ReliefWeb"
write.csv(temp, 'data/rw-value.csv', row.names = F)
# Fetching and merging all data.
for (i in 1:length(source_list)) {
src <- source_list[i]
x  <- read.csv(paste0('data/', src, '-', 'dataset.csv'))
y  <- read.csv(paste0('data/', src, '-', 'indicator.csv'))
z  <- read.csv(paste0('data/', src, '-', 'value.csv'))
#     print(ncol(x))
#     print(ncol(y))
#     print(ncol(z))
#
#     print(names(x))
#     print(names(y))
#     print(names(z))
#
if (i == 1) {
final_dataset <- x
final_indicator <- y
final_value <- z
}
else {
final_dataset <- rbind(final_dataset, x)
final_indicator <- rbind(final_dataset, y)
final_value <- rbind(final_dataset, z)
}
}
names(temp)
# Fetching and merging all data.
for (i in 1:length(source_list)) {
src <- source_list[i]
x  <- read.csv(paste0('data/', src, '-', 'dataset.csv'))
y  <- read.csv(paste0('data/', src, '-', 'indicator.csv'))
z  <- read.csv(paste0('data/', src, '-', 'value.csv'))
#     print(ncol(x))
#     print(ncol(y))
#     print(ncol(z))
#
#     print(names(x))
#     print(names(y))
#     print(names(z))
#
if (i == 1) {
final_dataset <<- x
final_indicator <<- y
final_value <<- z
}
else {
final_dataset <<- rbind(final_dataset, x)
final_indicator <<- rbind(final_dataset, y)
final_value <<- rbind(final_dataset, z)
}
}
nrow(temp)
View(final_dataset)
temp <- read.csv('data/sw-value.csv')
names(temp)
test <- rbind(final_dataset, temp)
names(final_dataset)
names(final_value)
# Fetching and merging all data.
for (i in 1:length(source_list)) {
src <- source_list[i]
x  <- read.csv(paste0('data/', src, '-', 'dataset.csv'))
y  <- read.csv(paste0('data/', src, '-', 'indicator.csv'))
z  <- read.csv(paste0('data/', src, '-', 'value.csv'))
#     print(ncol(x))
#     print(ncol(y))
#     print(ncol(z))
#
#     print(names(x))
#     print(names(y))
#     print(names(z))
#
if (i == 1) {
final_dataset <<- x
final_indicator <<- y
final_value <<- z
}
else {
final_dataset <<- rbind(final_dataset, x)
final_indicator <<- rbind(final_indicator y)
final_value <<- rbind(final_value, z)
}
}
# Fetching and merging all data.
for (i in 1:length(source_list)) {
src <- source_list[i]
x  <- read.csv(paste0('data/', src, '-', 'dataset.csv'))
y  <- read.csv(paste0('data/', src, '-', 'indicator.csv'))
z  <- read.csv(paste0('data/', src, '-', 'value.csv'))
#     print(ncol(x))
#     print(ncol(y))
#     print(ncol(z))
#
#     print(names(x))
#     print(names(y))
#     print(names(z))
#
if (i == 1) {
final_dataset <<- x
final_indicator <<- y
final_value <<- z
}
else {
final_dataset <<- rbind(final_dataset, x)
final_indicator <<- rbind(final_indicator y)
final_value <<- rbind(final_value, z)
}
}
# Fetching and merging all data.
for (i in 1:length(source_list)) {
src <- source_list[i]
x  <- read.csv(paste0('data/', src, '-', 'dataset.csv'))
y  <- read.csv(paste0('data/', src, '-', 'indicator.csv'))
z  <- read.csv(paste0('data/', src, '-', 'value.csv'))
#     print(ncol(x))
#     print(ncol(y))
#     print(ncol(z))
#
#     print(names(x))
#     print(names(y))
#     print(names(z))
#
if (i == 1) {
final_dataset <<- x
final_indicator <<- y
final_value <<- z
}
else {
final_dataset <<- rbind(final_dataset, x)
final_indicator <<- rbind(final_indicator, y)
final_value <<- rbind(final_value, z)
}
}
View(final_dataset)
View(final_indicator)
write.csv(final_dataset, 'dataset.csv', row.names = F)
write.csv(final_indicator, 'indicator.csv', row.names = F)
write.csv(final_value, 'value.csv', row.names = F)
library(sqldf)
write.csv(final_dataset, 'frog-data/dataset.csv', row.names = F)
write.csv(final_indicator, 'frog-data/indicator.csv', row.names = F)
write.csv(final_value, 'frog-data/value.csv', row.names = F)
nrow(final_value)
db <- dbConnect(SQLite(), dbname="db.sqlite")
dbWriteTable(db, "dataset", dtset, row.names = FALSE, overwrite = TRUE)
dbWriteTable(db, "indicator", indic, row.names = FALSE, overwrite = TRUE)
dbWriteTable(db, "value", zValue, row.names = FALSE, overwrite = TRUE)
# for testing purposes
# test <- dbReadTable(db, "value")
dbDisconnect(db)
db <- dbConnect(SQLite(), dbname="db.sqlite")
dbWriteTable(db, "dataset", final_dataset, row.names = FALSE, overwrite = TRUE)
dbWriteTable(db, "indicator", final_indicator, row.names = FALSE, overwrite = TRUE)
dbWriteTable(db, "value", final_value, row.names = FALSE, overwrite = TRUE)
dbDisconnect(db)
db <- dbConnect(SQLite(), dbname="db.sqlite")
test <- dbReadTable(db, "value")
dbDisconnect(db)
View(test)
nrow(final_indicator)
View(final_indicator)
View(final_dataset)
View(final_value)
length(unique(final_value$source))
nrow(final_dataset)
db <- dbConnect(SQLite(), dbname="frog-data/db.sqlite")
dbWriteTable(db, "dataset", final_dataset, row.names = FALSE, overwrite = TRUE)
dbWriteTable(db, "indicator", final_indicator, row.names = FALSE, overwrite = TRUE)
dbWriteTable(db, "value", final_value, row.names = FALSE, overwrite = TRUE)
dbDisconnect(db)
names(final_value)
names(final_indicator)
View(final_indicator)
names(final_dataset)
View(final_dataset)
